<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>用户列表 - 门禁管理</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .actions a { margin-right: 10px; text-decoration: none; color: #007bff; }
        .actions a.delete { color: red; }
        .container { max-width: 1000px; margin: auto; }
        h1 { text-align: center; }
        .add-user-btn {
            display: block;
            width: fit-content;
            margin: 20px 0;
            padding: 10px 15px;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>用户列表</h1>
        <!-- 你可以在这里添加搜索表单 -->
        <a href="{{ url_for('menjin.add_user_page') }}" class="add-user-btn">添加新用户</a>

        {% if users %}
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>工号</th>
                        <th>姓名</th>
                        <th>卡号</th>
                        <th>部门</th>
                        <th>权限类型</th>
                        <th>开始日期</th>
                        <th>结束日期</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td>{{ user.f_ConsumerID }}</td>
                        <td>{{ user.f_ConsumerNO }}</td>
                        <td>{{ user.f_ConsumerName }}</td>
                        <td>{{ user.f_CardNO if user.f_CardNO is not none else '' }}</td>
                        <td>{{ user.DepartmentName if user.DepartmentName is not none else '未分配' }}</td>
                        <td>{{ user.PrivilegeType if user.PrivilegeType is not none else '未指定' }}</td>
                        <td>{{ user.f_BeginYMD.strftime('%Y-%m-%d') if user.f_BeginYMD else '' }}</td>
                        <td>{{ user.f_EndYMD.strftime('%Y-%m-%d') if user.f_EndYMD else '' }}</td>
                        <td class="actions">
                            <a href="#">编辑</a> {# 你需要为编辑功能创建路由和页面 #}
                            <a href="{{ url_for('menjin.delete_user_action', consumer_no=user.f_ConsumerNO) }}"
                               onclick="return confirm('确定要删除用户 {{ user.f_ConsumerName }} (工号: {{ user.f_ConsumerNO }}) 吗？');"
                               class="delete">删除</a>
                            <a href="{{ url_for('menjin.manage_user_privileges_page', consumer_no=user.f_ConsumerNO) }}">管理权限</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>没有找到用户数据。</p>
        {% endif %}
    </div>
</body>
</html>